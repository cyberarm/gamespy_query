#!/usr/bin/env ruby

require 'gamespy_query'

# Parse commandline arguments
options = GamespyQuery::MasterOptions.parse

# TODO: Options..
geo = nil
game = "arma2oapc"

options.tasks.each do |t|
  opts = {}
  task = if t.is_a?(Array)
    opts = t[1]
    t[0]
  else
    t
  end

  case task
    when :list
      master = GamespyQuery::Master.new(geo, game)
      list = master.get_server_list(nil, true, geo)
      puts list
    when :process
      master = GamespyQuery::Master.new(geo, game)
      process = master.process
      puts process
  end
end
